/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [32,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [33,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [34,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [35,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [36,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [37,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [38,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [39,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [40,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [41,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [42,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [43,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [44,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [45,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [46,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [47,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [48,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [49,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [50,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [51,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [52,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [53,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [54,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [55,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [56,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [57,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [58,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [59,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [60,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [61,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [62,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
/opt/conda/conda-bld/pytorch_1712609048481/work/aten/src/ATen/native/cuda/Indexing.cu:1289: indexSelectLargeIndex: block: [6,0,0], thread: [63,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
8909 tensor([[0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        ...,
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0],
        [0, 0, 0,  ..., 0, 0, 0]], device='cuda:0')
8909 tensor([[[   1, 5877, 8058,  ...,    0,    0,    0],
         [   0,    2, 1113,  ...,    0,    0,    0],
         [   1, 1059, 1094,  ...,    0,    0,    0],
         ...,
         [2878, 2879,    0,  ...,    0,    0,    0],
         [2719, 2722, 3758,  ...,    0,    0,    0],
         [7048, 8858,    0,  ...,    0,    0,    0]],

        [[   1, 5877, 8058,  ...,    0,    0,    0],
         [   0,    2, 1113,  ...,    0,    0,    0],
         [   1, 1059, 1094,  ...,    0,    0,    0],
         ...,
         [2878, 2879,    0,  ...,    0,    0,    0],
         [2719, 2722, 3758,  ...,    0,    0,    0],
         [7048, 8858,    0,  ...,    0,    0,    0]],

        [[   1, 5877, 8058,  ...,    0,    0,    0],
         [   0,    2, 1113,  ...,    0,    0,    0],
         [   1, 1059, 1094,  ...,    0,    0,    0],
         ...,
         [2878, 2879,    0,  ...,    0,    0,    0],
         [2719, 2722, 3758,  ...,    0,    0,    0],
         [7048, 8858,    0,  ...,    0,    0,    0]],

        ...,

        [[   1, 5877, 8058,  ...,    0,    0,    0],
         [   0,    2, 1113,  ...,    0,    0,    0],
         [   1, 1059, 1094,  ...,    0,    0,    0],
         ...,
         [2878, 2879,    0,  ...,    0,    0,    0],
         [2719, 2722, 3758,  ...,    0,    0,    0],
         [7048, 8858,    0,  ...,    0,    0,    0]],

        [[   1, 5877, 8058,  ...,    0,    0,    0],
         [   0,    2, 1113,  ...,    0,    0,    0],
         [   1, 1059, 1094,  ...,    0,    0,    0],
         ...,
         [2878, 2879,    0,  ...,    0,    0,    0],
         [2719, 2722, 3758,  ...,    0,    0,    0],
         [7048, 8858,    0,  ...,    0,    0,    0]],

        [[   1, 5877, 8058,  ...,    0,    0,    0],
         [   0,    2, 1113,  ...,    0,    0,    0],
         [   1, 1059, 1094,  ...,    0,    0,    0],
         ...,
         [2878, 2879,    0,  ...,    0,    0,    0],
         [2719, 2722, 3758,  ...,    0,    0,    0],
         [7048, 8858,    0,  ...,    0,    0,    0]]], device='cuda:0',
       dtype=torch.int32)
21 tensor([[[122, 459,  77,  ...,   0,   0,   0],
         [122,  68,  52,  ...,   0,   0,   0],
         [ 68, 105,  74,  ...,   0,   0,   0],
         ...,
         [258, 683,   0,  ...,   0,   0,   0],
         [452,  18, 789,  ...,   0,   0,   0],
         [674,   9,   0,  ...,   0,   0,   0]],

        [[122, 459,  77,  ...,   0,   0,   0],
         [122,  68,  52,  ...,   0,   0,   0],
         [ 68, 105,  74,  ...,   0,   0,   0],
         ...,
         [258, 683,   0,  ...,   0,   0,   0],
         [452,  18, 789,  ...,   0,   0,   0],
         [674,   9,   0,  ...,   0,   0,   0]],

        [[122, 459,  77,  ...,   0,   0,   0],
         [122,  68,  52,  ...,   0,   0,   0],
         [ 68, 105,  74,  ...,   0,   0,   0],
         ...,
         [258, 683,   0,  ...,   0,   0,   0],
         [452,  18, 789,  ...,   0,   0,   0],
         [674,   9,   0,  ...,   0,   0,   0]],

        ...,

        [[122, 459,  77,  ...,   0,   0,   0],
         [122,  68,  52,  ...,   0,   0,   0],
         [ 68, 105,  74,  ...,   0,   0,   0],
         ...,
         [258, 683,   0,  ...,   0,   0,   0],
         [452,  18, 789,  ...,   0,   0,   0],
         [674,   9,   0,  ...,   0,   0,   0]],

        [[122, 459,  77,  ...,   0,   0,   0],
         [122,  68,  52,  ...,   0,   0,   0],
         [ 68, 105,  74,  ...,   0,   0,   0],
         ...,
         [258, 683,   0,  ...,   0,   0,   0],
         [452,  18, 789,  ...,   0,   0,   0],
         [674,   9,   0,  ...,   0,   0,   0]],

        [[122, 459,  77,  ...,   0,   0,   0],
         [122,  68,  52,  ...,   0,   0,   0],
         [ 68, 105,  74,  ...,   0,   0,   0],
         ...,
         [258, 683,   0,  ...,   0,   0,   0],
         [452,  18, 789,  ...,   0,   0,   0],
         [674,   9,   0,  ...,   0,   0,   0]]], device='cuda:0',
       dtype=torch.int32)
Traceback (most recent call last):
  File "/home/shenshiyu/SmartTrafficFramework/train.py", line 189, in <module>
    train3(cfg, data_loader)
  File "/home/shenshiyu/SmartTrafficFramework/task3/train_mae.py", line 145, in train
    logits, loss = model(x, condition, adj_table, y, None , None, special_mask_)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/SmartTrafficFramework/task3/model_mae.py", line 672, in forward
    adj = self.token_embedding_table(weighted_adj[0].int()) + self.weight_embedding_table(weighted_adj[1].int()) + self.geolocation_embedding.to(x.device)
                                                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/SmartTrafficFramework/task3/model_mae.py", line 22, in forward
    x = self.embedding(x)
        ^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1532, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1541, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/modules/sparse.py", line 163, in forward
    return F.embedding(
           ^^^^^^^^^^^^
  File "/home/shenshiyu/anaconda3/envs/traffic/lib/python3.12/site-packages/torch/nn/functional.py", line 2264, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: device-side assert triggered
Compile with `TORCH_USE_CUDA_DSA` to enable device-side assertions.

